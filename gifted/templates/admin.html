{% extends 'layout.html' %}

{% block title %}
admin
{% endblock %}

{% block main %}
<h6>Create a new event</h6>
    <form action="/admin/events" method="post">
        <div class="form-row justify-content-center">
            <div class="col-auto">
                <input class="form-control" name="title" placeholder="title" type="text" autocomplete="off" autofocus>
            </div>
            <div class="col-auto">
                <input class="form-control" name="description" placeholder="description">
            </div>
            <div class="col-auto">
                <input class="form-control" name="startsOn" placeholder="event start" type="date" aria-labelledby="startHelp">
                <small id="startHelp" class="form-text text-muted">Event start</small>
            </div>
            <div class="col-auto">
                <input class="form-control" name="endsOn" placeholder="event end" type="date" aria-labelledby="endHelp">
                <small id="endHelp" class="form-text text-muted">Event end</small>
            </div>
            <div class="col-auto">
                <button class="btn btn-primary" type="submit">create</button>
            </div>
        </div>
    </form>
<hr/>
<h4>Events</h4>
    {% if not events %}
        <p>No active events</p>
    {% else %}
        <table class="table">
            <thead class="thead-light">
                <tr>
                    <th scope="col">id</th>
                    <th scope="col">title</th>
                    <th scope="col">created on</th>
                    <th scope="col">starts on</th>
                    <th scope="col">ends on</th>
                    <th scope="col"></th>
                </tr>
            </thead>
            <tbody>
                {% for event in events %}
                <tr>
                    <th scope="row">{{ event.id }}</th>
                    <td><a href="/admin/events/{{ event.id }}">{{ event.title }}</a></td>
                    <td>{{ event.created_on }}</td>
                    <td>{{ event.starts_on }}</td>
                    <td>{{ event.ends_on }}</td>
                    <td>
                        <form action="/admin/events/delete" method="post">
                            <input hidden name="id" type="number" value="{{ event.id }}">
                            <button class="btn btn-danger btn-sm" type="submit">delete</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}
<hr/>
<h6>Invite someone to an event</h6>
    <form action="/admin/invites" method="post">
        <div class="form-row justify-content-center">
            <div class="col-3">
                <input autocomplete="off" autofocus class="form-control" name="email" placeholder="email" type="email">
            </div>
            <div class="input-group col-6">
                <div class="input-group-prepend">
                    <label class="input-group-text" for="eventSelect">event</label>
                </div>
                <select class="custom-select" id="eventSelect" name="eventId">
                    <option selected>Pick an event...</option>
                    {% for event in events %}
                        <option value="{{ event.id }}">{{ event.title }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-auto">
                <button class="btn btn-primary" type="submit">invite</button>
            </div>
        </div>
    </form>
<hr/>
<h4>Invites</h4>
    {% if not invites %}
        <p>No invites pending</p>
    {% else %}
        <table class="table">
            <thead class="thead-light">
                <tr>
                    <th scope="col">id</th>
                    <th scope="col">email</th>
                    <th scope="col">event</th>
                    <th scope="col">created</th>
                    <th scope="col">expired</th>
                    <th scope="col">code</th>
                    <th scope="col">used</th>
                    <th scope="col"></th>
                </tr>
            </thead>
            <tbody>
                {% for invite in invites %}
                <tr>
                    <th scope="row">{{ invite.id }}</th>
                    <td>{{ invite.email }}</td>
                    <td>{{ invite.event_id }}</td>
                    <td>{{ invite.created_on }}</td>
                    <td>{{ invite.expires_on | is_expired }}</td>
                    <td>{{ invite.code }}</td>
                    <td>{{ invite.is_used | pretty_boolean }}</td>
                    <td>
                        <form action="/admin/invites/{{ invite.id }}/revoke" method="post">
                            <button class="btn btn-danger btn-sm" type="submit">revoke</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}
{% endblock %}
